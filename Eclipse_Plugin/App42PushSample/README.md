App42-Android-Push-Sample
==========================


# About Application

1. This application shows how can we integrate our application for PushNotification using App42 API.

# Running Sample

This is a sample Android app is made by using App42 backend platform. It uses Push Notification API of App42 platform.
Here are the few easy steps to run this sample app.

1. [Register] (https://apphq.shephertz.com/register) with App42 platform.
2. Create an app once, you are on Quick start page after registration.
3. If you are already registered, login to [AppHQ] (http://apphq.shephertz.com) console and create an app from App Manager Tab.
4. To use PushNotification service in your application open this [link] (https://code.google.com/apis/console/b/0/?noredirect&pli=1) and create a new project here.
5. Click on services option in Google console and enable Google Cloud Messaging for Android service.
6. Click on API Access tab and create a new server key for your application with blank server information.
7. Go to [AppHQ] (http://apphq.shephertz.com) console and click on Push Notification and select Android Settings in Settings option.
8. Select your app and copy server key that is generated by using Google API console in step 6, and submit it.
9. Download the project from [here] (https://github.com/shephertz/App42-Android-Push-Sample/archive/master.zip) and import it in the eclipse.
10. Open MainActivty.java file in sample app and make following changes.

```
A. Replace api-Key and secret-Key that you have received in step 2 or 3 at line number 18 and 19.
C. Replace your user-id by which you want to register your application for PushNotification at line number 20.
B. Replace project-no with your Google Project Number at line number 21.
```
11.Build your android application and install on your android device.

__Test and verify PushNotification__
  
```
A. After registering for PushNotification go to AppHQ console and click on Push Notification and select 
  application after selecting User tab.
B. Select desired user from registered UserList and click on Send Message Button.
C. Send appropriate message to user by clicking Send Button.

```

__Send Message using App42 API :__ If you want to send PushNotification message using App42 API , pass the userId and 
message in below method .
  
```
PushNotificationService pushService=App42API.buildPushNotificationService();
pushService.sendPushMessageToUser(userId,message);

```


__Customize PushNotification Message:__ You can also customize your PushNotification message by changing following code in App42GCMService.java file accordingly.
  
```
  Notification notification = new NotificationCompat.Builder(context)
				.setContentTitle(title)
				.setContentText(message)
				.setContentIntent(intent)
				.setSmallIcon(icon)
				.setWhen(when)
				.setNumber(++msgCount)
				.setLargeIcon(getBitmapFromURL(LARGE_IMAGE_URL))
				.setLights(Color.YELLOW, 1, 2).setAutoCancel(true).build();

		notification.defaults |= Notification.DEFAULT_SOUND;
		notification.defaults |= Notification.DEFAULT_VIBRATE;
		notificationManager.notify(0, notification);

```

__PushNotification Registration:__ Push Notification registration is done by code written in MainActivty.java file.
  
```
      App42API.initialize(
	                this,
	                "<YOUR API KEY>",
	                "<YOUR SECRET KEY>");
	        App42API.setLoggedInUser("<Logged In User>") ;
	        Util.registerWithApp42("<Your Google Project No>");

```


__Change Message Activty:__ You can navigate to desired Activty ,when message is open. For this you can replace MessageActivity with 
that Activty in AndroidManifest.xml file. 
  
```
     <meta-data android:name="onMessageOpen" android:value="com.example.app42sample.MessageActivity" />

```

__Customize Application package name__ If you want to customize sample according your Application package name,please 
make these changes in AndroidManifest.xml file. 
  
```
 <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.VIBRATE" />
     <uses-permission android:name="android.permission.WAKE_LOCK" />

    <!-- GCM requires a Google account. -->
    <uses-permission android:name="android.permission.GET_ACCOUNTS" />

    <!-- Keeps the processor from sleeping when a message is received. -->
    <uses-permission android:name="android.permission.WAKE_LOCK" />

    <!--
     Creates a custom permission so only this app can receive its messages.

     NOTE: the permission *must* be called PACKAGE.permission.C2D_MESSAGE,
           where PACKAGE is the application's package name.
    -->
    <permission
        android:name="<Your Package Name>.permission.C2D_MESSAGE"
        android:protectionLevel="signature" />

    <uses-permission android:name="<Your Package Name>.permission.C2D_MESSAGE" />

    <!-- This app has permission to register and receive data message. -->
    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
    
    <receiver
            android:name="com.example.app42sample.App42GCMReceiver"
            android:permission="com.google.android.c2dm.permission.SEND" >
            <intent-filter>

                <!-- Receives the actual messages. -->
                <action android:name="com.google.android.c2dm.intent.RECEIVE" />
                <!-- Receives the registration id. -->
                <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
                    <!-- Your package name here -->
                <category android:name="<Your Package Name>" />
            </intent-filter>
        </receiver>
         <service android:name="com.example.app42sample.App42GCMService" >
        </service>
     

```
